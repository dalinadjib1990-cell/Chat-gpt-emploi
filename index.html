<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DALI AI AUTOU - تشخيص السيارات الجزائرية</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'cairo': ['Cairo', 'sans-serif'],
                    },
                    colors: {
                        primary: '#5D5CDE',
                        secondary: '#FF6B35',
                        accent: '#00D9FF',
                        dark: '#0A0A0B',
                        darker: '#060607'
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #0A0A0B 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
        }
        
        .engine-bg {
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 600"><defs><radialGradient id="engineGrad" cx="50%" cy="50%" r="50%"><stop offset="0%" style="stop-color:%23333;stop-opacity:0.3"/><stop offset="100%" style="stop-color:%23000;stop-opacity:0.1"/></radialGradient></defs><rect width="1000" height="600" fill="url(%23engineGrad)"/><g stroke="%23444" stroke-width="1" fill="none" opacity="0.3"><circle cx="200" cy="150" r="30"/><circle cx="400" cy="200" r="25"/><circle cx="600" cy="180" r="35"/><circle cx="800" cy="160" r="28"/><rect x="150" y="300" width="700" height="200" rx="20"/><rect x="200" y="320" width="600" height="50" rx="10"/><rect x="250" y="390" width="500" height="80" rx="15"/></g></svg>') center/cover no-repeat;
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .code-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(93, 92, 222, 0.3);
        }
        
        .language-toggle {
            background: linear-gradient(45deg, #5D5CDE, #00D9FF);
        }
        
        .glow-text {
            text-shadow: 0 0 10px #00D9FF, 0 0 20px #00D9FF, 0 0 30px #00D9FF;
        }
        
        .diagnostic-result {
            background: linear-gradient(145deg, rgba(93, 92, 222, 0.1), rgba(0, 217, 255, 0.1));
            border-left: 4px solid #5D5CDE;
        }
    </style>
</head>
<body class="bg-darker text-white">
    <!-- Header -->
    <header class="glass-card p-4 mb-6">
        <div class="container mx-auto flex items-center justify-between">
            <div class="flex items-center space-x-4 space-x-reverse">
                <div class="relative">
                    <div class="w-16 h-16 rounded-full overflow-hidden border-2 border-primary shadow-lg shadow-primary/50">
                        <img src="https://pfst.cf2.poecdn.net/base/image/ccbd962afe7a0f3a63986bc966a3e0fafe4af9f5a194c8af1d77cabd7149d328?w=1024&h=1536" 
                             alt="Developer Profile" class="w-full h-full object-cover">
                    </div>
                    <div class="absolute inset-0 rounded-full bg-gradient-to-r from-primary to-accent opacity-20 animate-pulse"></div>
                    <div class="absolute -bottom-6 left-1/2 transform -translate-x-1/2">
                        <span class="text-xs font-bold text-accent tracking-wider glow-text">DEVELOPER</span>
                    </div>
                </div>
                <div class="mr-4">
                    <h1 class="text-2xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent">
                        DALI AI AUTOU
                    </h1>
                    <p class="text-sm text-gray-400">تشخيص السيارات الجزائرية المتقدم</p>
                </div>
            </div>
            <button id="languageToggle" class="language-toggle px-4 py-2 rounded-lg text-white font-semibold">
                <span id="langText">عربي/دارجة</span>
            </button>
        </div>
    </header>

    <div class="container mx-auto px-4">
        <!-- Car Selection Section -->
        <div class="grid lg:grid-cols-3 gap-6 mb-8">
            <!-- Car Brand -->
            <div class="glass-card p-6 rounded-xl">
                <h3 class="text-lg font-semibold mb-4 text-accent">نوع السيارة</h3>
                <select id="carBrand" class="w-full bg-gray-800 border border-gray-600 rounded-lg p-3 text-white text-base focus:border-primary focus:outline-none">
                    <option value="">اختر نوع السيارة</option>
                    <option value="renault">رينو - Renault</option>
                    <option value="peugeot">بيجو - Peugeot</option>
                    <option value="citroen">ستروين - Citroën</option>
                    <option value="dacia">داتشيا - Dacia</option>
                    <option value="hyundai">هيونداي - Hyundai</option>
                    <option value="kia">كيا - Kia</option>
                    <option value="volkswagen">فولكس واجن - Volkswagen</option>
                    <option value="ford">فورد - Ford</option>
                    <option value="opel">أوبل - Opel</option>
                    <option value="fiat">فيات - Fiat</option>
                </select>
            </div>

            <!-- Car Model -->
            <div class="glass-card p-6 rounded-xl">
                <h3 class="text-lg font-semibold mb-4 text-accent">الموديل</h3>
                <select id="carModel" class="w-full bg-gray-800 border border-gray-600 rounded-lg p-3 text-white text-base focus:border-primary focus:outline-none" disabled>
                    <option value="">اختر الموديل أولاً</option>
                </select>
            </div>

            <!-- Car Year -->
            <div class="glass-card p-6 rounded-xl">
                <h3 class="text-lg font-semibold mb-4 text-accent">سنة الصنع</h3>
                <select id="carYear" class="w-full bg-gray-800 border border-gray-600 rounded-lg p-3 text-white text-base focus:border-primary focus:outline-none">
                    <option value="">اختر السنة</option>
                </select>
            </div>
        </div>

        <!-- OBD Code Search -->
        <div class="glass-card p-6 rounded-xl mb-6">
            <h3 class="text-xl font-semibold mb-4 text-accent">البحث عن كود OBD</h3>
            <div class="flex gap-4">
                <input type="text" id="codeSearch" placeholder="ادخل كود العطل (مثال: P0301)" 
                       class="flex-1 bg-gray-800 border border-gray-600 rounded-lg p-3 text-white text-base focus:border-primary focus:outline-none">
                <button id="searchBtn" class="bg-gradient-to-r from-primary to-accent px-6 py-3 rounded-lg font-semibold hover:shadow-lg transition-all">
                    تشخيص العطل
                </button>
            </div>
        </div>

        <!-- Common Codes Quick Access -->
        <div class="glass-card p-6 rounded-xl mb-6">
            <h3 class="text-xl font-semibold mb-4 text-accent">الأعطال الشائعة</h3>
            <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3">
                <button class="code-item bg-gray-800 hover:bg-gray-700 p-3 rounded-lg transition-all" data-code="P0301">P0301</button>
                <button class="code-item bg-gray-800 hover:bg-gray-700 p-3 rounded-lg transition-all" data-code="P0171">P0171</button>
                <button class="code-item bg-gray-800 hover:bg-gray-700 p-3 rounded-lg transition-all" data-code="P0420">P0420</button>
                <button class="code-item bg-gray-800 hover:bg-gray-700 p-3 rounded-lg transition-all" data-code="P0128">P0128</button>
                <button class="code-item bg-gray-800 hover:bg-gray-700 p-3 rounded-lg transition-all" data-code="P0442">P0442</button>
                <button class="code-item bg-gray-800 hover:bg-gray-700 p-3 rounded-lg transition-all" data-code="P0102">P0102</button>
            </div>
        </div>

        <!-- All Available Codes -->
        <div class="glass-card p-6 rounded-xl mb-6">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-xl font-semibold text-accent">جميع الأكواد المتاحة</h3>
                <button id="toggleCodesBtn" class="bg-gradient-to-r from-secondary to-primary px-4 py-2 rounded-lg font-semibold hover:shadow-lg transition-all">
                    عرض جميع الأكواد
                </button>
            </div>
            <div id="allCodesContainer" class="hidden">
                <div class="mb-4">
                    <input type="text" id="codeFilter" placeholder="البحث في الأكواد..." 
                           class="w-full bg-gray-800 border border-gray-600 rounded-lg p-3 text-white text-base focus:border-primary focus:outline-none">
                </div>
                <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 gap-2 max-h-96 overflow-y-auto" id="allCodesList">
                    <!-- Codes will be populated here -->
                </div>
            </div>
        </div>

        <!-- Diagnostic Result -->
        <div id="diagnosticResult" class="hidden">
            <div class="diagnostic-result glass-card p-6 rounded-xl engine-bg">
                <div class="bg-black bg-opacity-60 p-6 rounded-lg">
                    <h2 class="text-2xl font-bold mb-4 text-accent" id="resultTitle"></h2>
                    
                    <!-- Error Code Info -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold mb-2 text-primary">معلومات الكود</h3>
                        <div class="bg-gray-800 bg-opacity-80 p-4 rounded-lg">
                            <p class="text-yellow-400 font-mono text-lg" id="errorCode"></p>
                            <p class="text-gray-300" id="errorType"></p>
                        </div>
                    </div>

                    <!-- Algerian Dialect Explanation -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold mb-2 text-secondary">الشرح بالدارجة الجزائرية</h3>
                        <div class="bg-gray-800 bg-opacity-80 p-4 rounded-lg">
                            <p class="text-gray-300 leading-relaxed" id="dialectExplanation"></p>
                        </div>
                    </div>

                    <!-- Standard Arabic Explanation -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold mb-2 text-accent">الشرح بالعربية الفصحى</h3>
                        <div class="bg-gray-800 bg-opacity-80 p-4 rounded-lg">
                            <p class="text-gray-300 leading-relaxed" id="arabicExplanation"></p>
                        </div>
                    </div>

                    <!-- Solutions in Algerian Dialect -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold mb-2 text-secondary">الحلول (بالدارجة)</h3>
                        <div class="bg-gray-800 bg-opacity-80 p-4 rounded-lg">
                            <ul class="space-y-2" id="dialectSolutions"></ul>
                        </div>
                    </div>

                    <!-- Solutions in Standard Arabic -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold mb-2 text-accent">الحلول (بالفصحى)</h3>
                        <div class="bg-gray-800 bg-opacity-80 p-4 rounded-lg">
                            <ul class="space-y-2" id="arabicSolutions"></ul>
                        </div>
                    </div>

                    <!-- Severity Level -->
                    <div class="mb-4">
                        <h3 class="text-lg font-semibold mb-2 text-primary">مستوى الخطورة</h3>
                        <div class="flex items-center space-x-2 space-x-reverse">
                            <div id="severityIndicator" class="w-4 h-4 rounded-full"></div>
                            <span id="severityText" class="font-semibold"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dark mode detection
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // Car models data
        const carModels = {
            renault: ['Clio', 'Megane', 'Logan', 'Sandero', 'Fluence', 'Duster', 'Symbol', 'Kangoo'],
            peugeot: ['206', '207', '208', '301', '308', '408', '508', '2008', '3008', 'Partner'],
            citroen: ['C3', 'C4', 'C5', 'C-Elysée', 'Berlingo', 'Xsara Picasso', 'C4 Picasso'],
            dacia: ['Logan', 'Sandero', 'Duster', 'Dokker', 'Lodgy'],
            hyundai: ['i10', 'i20', 'Accent', 'Elantra', 'Tucson', 'Santa Fe'],
            kia: ['Picanto', 'Rio', 'Cerato', 'Optima', 'Sportage', 'Sorento'],
            volkswagen: ['Polo', 'Golf', 'Jetta', 'Passat', 'Tiguan', 'Touareg'],
            ford: ['Ka', 'Fiesta', 'Focus', 'Mondeo', 'Kuga', 'EcoSport'],
            opel: ['Corsa', 'Astra', 'Insignia', 'Mokka', 'Antara'],
            fiat: ['Punto', 'Tipo', 'Doblo', '500', 'Panda']
        };

        // Comprehensive OBD codes database - قاعدة بيانات شاملة لأكواد OBD
        const obdCodes = {
            // Engine Management Codes (P0xxx)
            'P0100': {
                type: 'دايرة حساس الهواء MAF',
                dialectExplanation: 'فيه مشكلة في دايرة حساس الهواء. الكمبيوتر مايقراش كمية الهواء لي داخلة للموتور.',
                arabicExplanation: 'عطل في دائرة مستشعر تدفق الهواء الشامل. وحدة التحكم لا تستطيع قراءة كمية الهواء الداخل للمحرك.',
                dialectSolutions: ['شوف الكابلات تاع الحساس', 'نضف الحساس بمنتج خاص', 'بدل الحساس إذا خرب'],
                arabicSolutions: ['فحص أسلاك المستشعر', 'تنظيف المستشعر بمنظف مخصص', 'استبدال المستشعر إذا تلف'],
                severity: 'متوسط'
            },
            'P0101': {
                type: 'خطأ في حساس الهواء (MAF)',
                dialectExplanation: 'حساس الهواء لي فالمحرك خرب أو متسخ. راه يقيس كمية الهواء لي داخلة للموتور باش يحسب البنزين المناسب.',
                arabicExplanation: 'عطل في مستشعر تدفق الهواء الشامل (MAF). هذا المستشعر يقيس كمية الهواء الداخل للمحرك لحساب كمية الوقود المناسبة.',
                dialectSolutions: ['نضف حساس الهواء بسبري خاص', 'شوف الكابلات إذا كانوا مقطوعين', 'بدل حساس الهواء إذا خرب نهائياً'],
                arabicSolutions: ['تنظيف مستشعر تدفق الهواء بمنظف خاص', 'فحص أسلاك التوصيل للتأكد من سلامتها', 'استبدال المستشعر إذا كان تالفاً بشكل نهائي'],
                severity: 'متوسط'
            },
            'P0102': {
                type: 'حساس الهواء إشارة ضعيفة',
                dialectExplanation: 'حساس الهواء مايعطيش إشارة قوية للكمبيوتر. ممكن يكون متسخ أو الكابل قطع.',
                arabicExplanation: 'مستشعر تدفق الهواء يرسل إشارة ضعيفة لوحدة التحكم. قد يكون بسبب تراكم الأوساخ أو انقطاع في الأسلاك.',
                dialectSolutions: ['نضف المستشعر بصباغ خاص', 'شوف الكابلات والقوائم', 'تأكد من الفولتاج لي جاي للحساس'],
                arabicSolutions: ['تنظيف المستشعر بمنظف إلكتروني مخصص', 'فحص كابلات التوصيل والموصلات', 'التحقق من الجهد الكهربائي الواصل للمستشعر'],
                severity: 'متوسط'
            },
            'P0103': {
                type: 'حساس الهواء إشارة عالية',
                dialectExplanation: 'حساس الهواء يعطي إشارة قوية برشا للكمبيوتر. ممكن يكون فيه قطع في الدايرة أو الحساس خرب.',
                arabicExplanation: 'مستشعر تدفق الهواء يرسل إشارة عالية جداً لوحدة التحكم. قد يكون هناك قصر في الدائرة أو تلف في المستشعر.',
                dialectSolutions: ['شوف الكابلات إذا فيها قطع', 'تأكد من التأريض', 'بدل الحساس'],
                arabicSolutions: ['فحص الأسلاك للبحث عن قصر كهربائي', 'التحقق من التأريض', 'استبدال المستشعر'],
                severity: 'متوسط'
            },
            'P0110': {
                type: 'حساس درجة حرارة الهواء الداخل',
                dialectExplanation: 'حساس لي يقيس حرارة الهواء الداخل للموتور خرب. هذا يأثر على حساب كمية البنزين.',
                arabicExplanation: 'مستشعر درجة حرارة الهواء الداخل تالف. هذا يؤثر على حساب نسبة الوقود والهواء.',
                dialectSolutions: ['بدل حساس الحرارة', 'شوف الكابلات', 'نضف المستشعر'],
                arabicSolutions: ['استبدال مستشعر الحرارة', 'فحص الأسلاك', 'تنظيف المستشعر'],
                severity: 'متوسط'
            },
            'P0115': {
                type: 'حساس حرارة المبرد',
                dialectExplanation: 'حساس الحرارة تاع الماء (لورادياتور) خرب. الكمبيوتر مايعرفش درجة حرارة الموتور.',
                arabicExplanation: 'مستشعر درجة حرارة سائل التبريد تالف. وحدة التحكم لا تستطيع معرفة درجة حرارة المحرك.',
                dialectSolutions: ['بدل حساس الحرارة تاع الماء', 'شوف الكابلات والقوائم', 'تأكد من التأريض'],
                arabicSolutions: ['استبدال مستشعر حرارة سائل التبريد', 'فحص الأسلاك والموصلات', 'التحقق من التأريض'],
                severity: 'مرتفع'
            },
            'P0120': {
                type: 'حساس البطاطة (TPS)',
                dialectExplanation: 'حساس البطاطة (دواسة البنزين) خرب. الكمبيوتر مايعرفش قداش ضاغط على البطاطة.',
                arabicExplanation: 'مستشعر موضع دواسة الوقود (TPS) تالف. وحدة التحكم لا تستطيع معرفة مدى ضغط السائق على الدواسة.',
                dialectSolutions: ['بدل حساس البطاطة', 'نضف الحساس', 'شوف الكابلات'],
                arabicSolutions: ['استبدال مستشعر موضع الدواسة', 'تنظيف المستشعر', 'فحص الأسلاك'],
                severity: 'مرتفع'
            },
            'P0125': {
                type: 'حرارة المبرد غير كافية',
                dialectExplanation: 'الموتور مايسخنش على الدرجة المطلوبة بسرعة. ممكن تكون التيرموسطا خربانة.',
                arabicExplanation: 'المحرك لا يصل إلى درجة حرارة التشغيل المطلوبة بالسرعة المناسبة. قد يكون منظم الحرارة تالفاً.',
                dialectSolutions: ['بدل التيرموسطا', 'شوف نظام التبريد', 'تأكد من مستوى الماء'],
                arabicSolutions: ['استبدال منظم الحرارة', 'فحص نظام التبريد', 'التحقق من مستوى سائل التبريد'],
                severity: 'متوسط'
            },
            'P0128': {
                type: 'التيرموسطا مايوصلش لدرجة الحرارة',
                dialectExplanation: 'التيرموسطا (ثرموستات) خربانة أو مافتحتش في الوقت. الموتور مايسخنش على الدرجة المطلوبة.',
                arabicExplanation: 'منظم الحرارة (الثرموستات) لا يعمل بطريقة صحيحة. المحرك لا يصل إلى درجة حرارة التشغيل المثلى.',
                dialectSolutions: ['بدل التيرموسطا بوحدة جديدة', 'شوف إذا فيه هواء في دورة التبريد', 'تأكد من سائل التبريد (لورادياتور)'],
                arabicSolutions: ['استبدال منظم الحرارة بوحدة جديدة', 'فحص نظام التبريد للتأكد من عدم وجود هواء', 'التحقق من مستوى ونوعية سائل التبريد'],
                severity: 'متوسط'
            },
            'P0130': {
                type: 'حساس الأكسجين الأول',
                dialectExplanation: 'حساس الأكسجين لي قبل الكاتاليزير خرب. راه يقيس الأكسجين في غازات العادم.',
                arabicExplanation: 'مستشعر الأكسجين الأول (قبل المحول الحفزي) تالف. يقيس مستوى الأكسجين في غازات العادم.',
                dialectSolutions: ['بدل حساس الأكسجين', 'شوف الكابلات', 'نضف نظام العادم'],
                arabicSolutions: ['استبدال مستشعر الأكسجين', 'فحص الأسلاك', 'تنظيف نظام العادم'],
                severity: 'مرتفع'
            },
            'P0131': {
                type: 'حساس الأكسجين فولتاج منخفض',
                dialectExplanation: 'حساس الأكسجين مايعطيش فولتاج كافي. ممكن يكون خرب أو الكابل قطع.',
                arabicExplanation: 'مستشعر الأكسجين لا يعطي الجهد الكهربائي المطلوب. قد يكون تالفاً أو هناك مشكلة في الأسلاك.',
                dialectSolutions: ['بدل حساس الأكسجين', 'شوف الكابلات والفيش', 'تأكد من التأريض'],
                arabicSolutions: ['استبدال مستشعر الأكسجين', 'فحص الأسلاك والموصلات', 'التحقق من التأريض'],
                severity: 'مرتفع'
            },
            'P0132': {
                type: 'حساس الأكسجين فولتاج عالي',
                dialectExplanation: 'حساس الأكسجين يعطي فولتاج عالي برشا. ممكن يكون فيه قطع في الدايرة.',
                arabicExplanation: 'مستشعر الأكسجين يعطي جهداً كهربائياً عالياً جداً. قد يكون هناك قصر في الدائرة.',
                dialectSolutions: ['شوف الكابلات إذا فيها قطع', 'بدل الحساس', 'تأكد من الفولتاج'],
                arabicSolutions: ['فحص الأسلاك للبحث عن قصر', 'استبدال المستشعر', 'التحقق من الجهد'],
                severity: 'مرتفع'
            },
            'P0171': {
                type: 'خليط الهواء والبنزين فقير',
                dialectExplanation: 'الموتور يشرب هواء كثير أو بنزين قليل. راه يحوس يعدل الخليط باش يشتغل مليح.',
                arabicExplanation: 'خليط الوقود والهواء فقير جداً. النظام يحاول تعديل نسبة الخليط لكن الانحراف كبير.',
                dialectSolutions: ['شوف إذا فيه تسريب هواء في الإنتاك', 'نضف أو بدل فلتر البنزين', 'شوف طرمبة البنزين إذا تخدم مليح'],
                arabicSolutions: ['فحص مجمع السحب للبحث عن تسريبات الهواء', 'تنظيف أو استبدال مرشح الوقود', 'فحص مضخة الوقود والتأكد من أدائها'],
                severity: 'مرتفع'
            },
            'P0172': {
                type: 'خليط الهواء والبنزين غني',
                dialectExplanation: 'الموتور يشرب بنزين كثير أو هواء قليل. الخليط غني برشا.',
                arabicExplanation: 'خليط الوقود والهواء غني جداً. يوجد وقود أكثر من اللازم أو هواء أقل من المطلوب.',
                dialectSolutions: ['شوف فلتر الهواء إذا مسدود', 'نضف الإنجكتورز', 'شوف حساس الأكسجين'],
                arabicSolutions: ['فحص مرشح الهواء للتأكد من نظافته', 'تنظيف حاقنات الوقود', 'فحص مستشعر الأكسجين'],
                severity: 'مرتفع'
            },
            'P0200': {
                type: 'دايرة الإنجكتور',
                dialectExplanation: 'فيه مشكلة في دايرة الإنجكتورز. ممكن يكون فيه إنجكتور خرب أو مشكلة في الكابلات.',
                arabicExplanation: 'مشكلة في دائرة حاقنات الوقود. قد يكون أحد الحاقنات تالفاً أو مشكلة في الأسلاك.',
                dialectSolutions: ['شوف الإنجكتورز واحد واحد', 'تأكد من الكابلات', 'نضف الإنجكتورز'],
                arabicSolutions: ['فحص كل حاقن على حدة', 'التحقق من الأسلاك', 'تنظيف الحاقنات'],
                severity: 'مرتفع'
            },
            'P0300': {
                type: 'مشكلة إشعال عامة',
                dialectExplanation: 'الموتور فيه مشكلة في الإشعال بصفة عامة. ممكن تكون البوجيات أو البوبينات.',
                arabicExplanation: 'مشكلة عامة في نظام الإشعال. قد تكون شمعات الإشعال أو ملفات الإشعال أو الأسلاك.',
                dialectSolutions: ['شوف البوجيات كولهم', 'تأكد من البوبينات', 'شوف كابلات الإشعال'],
                arabicSolutions: ['فحص جميع شمعات الإشعال', 'التحقق من ملفات الإشعال', 'فحص أسلاك الإشعال'],
                severity: 'مرتفع'
            },
            'P0301': {
                type: 'مشكلة في إشعال السيليندر الأول',
                dialectExplanation: 'السيليندر الأول مايشعلش مليح. ممكن تكون البوجي خربانة أو البوبين مايخدمش.',
                arabicExplanation: 'خطأ في إشعال الأسطوانة الأولى. قد يكون بسبب شمعة الإشعال أو ملف الإشعال أو حاقن الوقود.',
                dialectSolutions: ['بدل البوجي (شمعة الإشعال) تاع السيليندر الأول', 'شوف البوبين إذا يعطي شرارة قوية', 'تأكد من الإنجكتور إذا يرش بنزين'],
                arabicSolutions: ['استبدال شمعة الإشعال للأسطوانة الأولى', 'فحص ملف الإشعال والتأكد من قوة الشرارة', 'التحقق من حاقن الوقود وتنظيفه إذا لزم الأمر'],
                severity: 'مرتفع'
            },
            'P0302': {
                type: 'مشكلة في إشعال السيليندر الثاني',
                dialectExplanation: 'السيليندر الثاني مايشعلش مليح. نفس المشكلة كالسيليندر الأول.',
                arabicExplanation: 'خطأ في إشعال الأسطوانة الثانية. نفس الأسباب المحتملة للأسطوانة الأولى.',
                dialectSolutions: ['بدل البوجي تاع السيليندر الثاني', 'شوف البوبين', 'تأكد من الإنجكتور'],
                arabicSolutions: ['استبدال شمعة الإشعال للأسطوانة الثانية', 'فحص ملف الإشعال', 'التحقق من حاقن الوقود'],
                severity: 'مرتفع'
            },
            'P0303': {
                type: 'مشكلة في إشعال السيليندر الثالث',
                dialectExplanation: 'السيليندر الثالث مايشعلش مليح. نفس المشكلة كالسيليندرات الأخرى.',
                arabicExplanation: 'خطأ في إشعال الأسطوانة الثالثة. نفس الأسباب المحتملة للأسطوانات الأخرى.',
                dialectSolutions: ['بدل البوجي تاع السيليندر الثالث', 'شوف البوبين', 'تأكد من الإنجكتور'],
                arabicSolutions: ['استبدال شمعة الإشعال للأسطوانة الثالثة', 'فحص ملف الإشعال', 'التحقق من حاقن الوقود'],
                severity: 'مرتفع'
            },
            'P0304': {
                type: 'مشكلة في إشعال السيليندر الرابع',
                dialectExplanation: 'السيليندر الرابع مايشعلش مليح. نفس المشكلة كالسيليندرات الأخرى.',
                arabicExplanation: 'خطأ في إشعال الأسطوانة الرابعة. نفس الأسباب المحتملة للأسطوانات الأخرى.',
                dialectSolutions: ['بدل البوجي تاع السيليندر الرابع', 'شوف البوبين', 'تأكد من الإنجكتور'],
                arabicSolutions: ['استبدال شمعة الإشعال للأسطوانة الرابعة', 'فحص ملف الإشعال', 'التحقق من حاقن الوقود'],
                severity: 'مرتفع'
            },
            'P0420': {
                type: 'الكاتاليزير مايخدمش مليح',
                dialectExplanation: 'البوت دوشابمون (العادم) فيه مشكلة. الكاتاليزير لي ينضف الغازات خرب أو عيا.',
                arabicExplanation: 'كفاءة المحول الحفزي أقل من الحد المطلوب. النظام لا يستطيع تنظيف غازات العادم بشكل كافي.',
                dialectSolutions: ['بدل الكاتاليزير بوحدة جديدة', 'شوف حساسات الأكسجين قبل وبعد الكاتاليزير', 'نضف نظام الوقود بمنتجات خاصة'],
                arabicSolutions: ['استبدال المحول الحفزي بوحدة جديدة', 'فحص مستشعرات الأكسجين قبل وبعد المحول', 'تنظيف نظام الوقود بمنتجات متخصصة'],
                severity: 'مرتفع'
            },
            'P0440': {
                type: 'نظام أبخرة الوقود EVAP',
                dialectExplanation: 'فيه مشكلة في نظام EVAP لي يجمع أبخرة البنزين. ممكن يكون تسريب أو فالف خربان.',
                arabicExplanation: 'مشكلة عامة في نظام استرداد أبخرة الوقود. قد يكون تسريب أو صمام تالف.',
                dialectSolutions: ['شوف غطا خزان البنزين', 'تأكد من الخراطيم', 'شوف فالف EVAP'],
                arabicSolutions: ['فحص غطاء خزان الوقود', 'التحقق من الخراطيم', 'فحص صمام نظام الأبخرة'],
                severity: 'منخفض'
            },
            'P0441': {
                type: 'تدفق غير صحيح في نظام EVAP',
                dialectExplanation: 'نظام EVAP مايخدمش كيما لازم. التدفق مش صحيح.',
                arabicExplanation: 'تدفق غير صحيح في نظام استرداد أبخرة الوقود. النظام لا يعمل كما هو مطلوب.',
                dialectSolutions: ['نضف فالف EVAP', 'شوف الخراطيم', 'تأكد من الفاكيوم'],
                arabicSolutions: ['تنظيف صمام نظام الأبخرة', 'فحص الخراطيم', 'التحقق من الفراغ'],
                severity: 'منخفض'
            },
            'P0442': {
                type: 'تسريب صغير في نظام البخار',
                dialectExplanation: 'فيه تسريب صغير في نظام EVAP لي يجمع أبخرة البنزين. ممكن يكون في الغطا تاع الخزان.',
                arabicExplanation: 'تسريب صغير في نظام استرداد أبخرة الوقود. قد يكون في غطاء خزان الوقود أو الخراطيم.',
                dialectSolutions: ['شوف غطا الخزان إذا محكم مليح', 'تأكد من خراطيم نظام EVAP', 'شوف الفالف تاع نظام الأبخرة'],
                arabicSolutions: ['فحص غطاء خزان الوقود والتأكد من إحكامه', 'التحقق من سلامة خراطيم نظام استرداد الأبخرة', 'فحص صمام نظام الأبخرة'],
                severity: 'منخفض'
            },
            'P0443': {
                type: 'دايرة فالف EVAP',
                dialectExplanation: 'فيه مشكلة في دايرة فالف EVAP. الكمبيوتر مايقدرش يتحكم في الفالف.',
                arabicExplanation: 'مشكلة في دائرة صمام نظام استرداد الأبخرة. وحدة التحكم لا تستطيع التحكم في الصمام.',
                dialectSolutions: ['بدل فالف EVAP', 'شوف الكابلات', 'تأكد من الفولتاج'],
                arabicSolutions: ['استبدال صمام نظام الأبخرة', 'فحص الأسلاك', 'التحقق من الجهد'],
                severity: 'منخفض'
            },
            'P0500': {
                type: 'حساس السرعة VSS',
                dialectExplanation: 'حساس السرعة تاع السيارة خرب. الكمبيوتر مايعرفش بقداش السيارة ماشية.',
                arabicExplanation: 'مستشعر سرعة المركبة تالف. وحدة التحكم لا تستطيع معرفة سرعة المركبة.',
                dialectSolutions: ['بدل حساس السرعة', 'شوف الكابلات', 'تأكد من الترس تاع الحساس'],
                arabicSolutions: ['استبدال مستشعر السرعة', 'فحص الأسلاك', 'التحقق من ترس المستشعر'],
                severity: 'متوسط'
            },
            'P0505': {
                type: 'مشكلة في تحكم الخمول',
                dialectExplanation: 'الموتور مايعرفش يحافظ على دورات الخمول. الIAC valve لي يتحكم في الهواء خربانة.',
                arabicExplanation: 'مشكلة في نظام التحكم بسرعة الخمول. صمام التحكم بالهواء في وضع الخمول لا يعمل بشكل صحيح.',
                dialectSolutions: ['نضف صمام IAC بسبري كاربوريتر', 'شوف الكابلات والموصلات', 'بدل الصمام إذا خرب'],
                arabicSolutions: ['تنظيف صمام التحكم بالهواء بمنظف الكاربوريتر', 'فحص الأسلاك والموصلات الكهربائية', 'استبدال الصمام إذا كان تالفاً'],
                severity: 'متوسط'
            },
            'P0506': {
                type: 'دورات خمول منخفضة',
                dialectExplanation: 'الموتور يدور بدورات قليلة في الخمول. ممكن يطفي أو يرتعش.',
                arabicExplanation: 'دورات المحرك في وضع الخمول أقل من المطلوب. قد يؤدي إلى توقف المحرك أو اهتزازه.',
                dialectSolutions: ['نضف صمام الخمول', 'شوف فلتر الهواء', 'تأكد من التوقيت'],
                arabicSolutions: ['تنظيف صمام الخمول', 'فحص مرشح الهواء', 'التحقق من توقيت المحرك'],
                severity: 'متوسط'
            },
            'P0507': {
                type: 'دورات خمول عالية',
                dialectExplanation: 'الموتور يدور بدورات عالية في الخمول. ممكن يكون فيه تسريب هواء.',
                arabicExplanation: 'دورات المحرك في وضع الخمول أعلى من المطلوب. قد يكون هناك تسريب هواء.',
                dialectSolutions: ['شوف إذا فيه تسريب هواء', 'نضف صمام الخمول', 'شوف الفاكيوم'],
                arabicSolutions: ['البحث عن تسريبات الهواء', 'تنظيف صمام الخمول', 'فحص نظام الفراغ'],
                severity: 'متوسط'
            },
            'P0562': {
                type: 'جهد كهربائي منخفض',
                dialectExplanation: 'الجهد الكهربائي في السيارة ضعيف. ممكن تكون البطارية أو الدينامو.',
                arabicExplanation: 'الجهد الكهربائي في النظام منخفض. قد تكون البطارية أو المولد.',
                dialectSolutions: ['شوف البطارية إذا صحيحة', 'تأكد من الدينامو', 'شوف الكابلات الكهربائية'],
                arabicSolutions: ['فحص البطارية والتأكد من حالتها', 'التحقق من المولد', 'فحص الأسلاك الكهربائية'],
                severity: 'مرتفع'
            },
            'P0563': {
                type: 'جهد كهربائي عالي',
                dialectExplanation: 'الجهد الكهربائي في السيارة عالي برشا. ممكن يكون الدينامو يشحن برشا.',
                arabicExplanation: 'الجهد الكهربائي في النظام عالي جداً. قد يكون المولد يشحن أكثر من اللازم.',
                dialectSolutions: ['شوف منظم الجهد تاع الدينامو', 'تأكد من البطارية', 'شوف الكابلات'],
                arabicSolutions: ['فحص منظم الجهد في المولد', 'التحقق من البطارية', 'فحص الأسلاك'],
                severity: 'مرتفع'
            },
            'P0601': {
                type: 'ذاكرة الكمبيوتر تالفة',
                dialectExplanation: 'ذاكرة كمبيوتر السيارة فيها مشكلة. ممكن تكون خربت أو فيها خطأ في البرنامج.',
                arabicExplanation: 'ذاكرة وحدة التحكم الداخلية تالفة. قد تحتاج إلى إعادة برمجة أو استبدال.',
                dialectSolutions: ['جرب تفرمت الكمبيوتر', 'شوف إذا يحتاج برمجة', 'ممكن تحتاج تبدل الكمبيوتر'],
                arabicSolutions: ['محاولة إعادة تهيئة وحدة التحكم', 'فحص إذا كانت تحتاج إعادة برمجة', 'قد تحتاج استبدال وحدة التحكم'],
                severity: 'مرتفع'
            },
            'P0700': {
                type: 'نظام ناقل الحركة',
                dialectExplanation: 'فيه مشكلة في نظام بوات الفيتاس (ناقل الحركة الأوتوماتيكي).',
                arabicExplanation: 'مشكلة عامة في نظام ناقل الحركة الأوتوماتيكي.',
                dialectSolutions: ['شوف زيت بوات الفيتاس', 'تأكد من مستوى الزيت', 'راجع متخصص في البوات'],
                arabicSolutions: ['فحص زيت ناقل الحركة', 'التحقق من مستوى الزيت', 'مراجعة متخصص في ناقل الحركة'],
                severity: 'مرتفع'
            },
            'P0720': {
                type: 'حساس سرعة ناقل الحركة',
                dialectExplanation: 'حساس السرعة تاع بوات الفيتاس خرب. مايقيسش السرعة مليح.',
                arabicExplanation: 'مستشعر سرعة ناقل الحركة تالف. لا يقيس السرعة بشكل صحيح.',
                dialectSolutions: ['بدل حساس السرعة', 'شوف الكابلات', 'تأكد من الترس'],
                arabicSolutions: ['استبدال مستشعر السرعة', 'فحص الأسلاك', 'التحقق من الترس'],
                severity: 'مرتفع'
            },
            'P1000': {
                type: 'نظام التشخيص غير مكتمل',
                dialectExplanation: 'الكمبيوتر مازال مايكملش فحص كامل للسيارة. خلي السيارة تمشي شوية.',
                arabicExplanation: 'نظام التشخيص الذاتي لم يكتمل بعد. يحتاج قيادة السيارة لمسافة معينة.',
                dialectSolutions: ['خلي السيارة تمشي 50-100 كيلومتر', 'اتبع دورة القيادة المطلوبة', 'اصبر الكمبيوتر يكمل الفحص'],
                arabicSolutions: ['قيادة السيارة لمسافة 50-100 كيلومتر', 'اتباع دورة القيادة المطلوبة', 'انتظار اكتمال الفحص الذاتي'],
                severity: 'منخفض'
            },
            // Transmission Codes (P0xxx)
            'P0740': {
                type: 'مشكلة في قارنة ناقل الحركة',
                dialectExplanation: 'قارنة بوات الفيتاس مايخدمش مليح. ممكن تحس بهزة أو انزلاق.',
                arabicExplanation: 'مشكلة في قابض ناقل الحركة الأوتوماتيكي. قد تشعر بهزة أو انزلاق.',
                dialectSolutions: ['بدل زيت البوات', 'شوف فلتر البوات', 'ممكن تحتاج إصلاح البوات'],
                arabicSolutions: ['تغيير زيت ناقل الحركة', 'فحص مرشح ناقل الحركة', 'قد تحتاج إصلاح ناقل الحركة'],
                severity: 'مرتفع'
            },
            // ABS Codes (P1xxx)
            'P1500': {
                type: 'نظام ABS',
                dialectExplanation: 'فيه مشكلة في نظام ABS (المكابح المانعة للانزلاق).',
                arabicExplanation: 'مشكلة في نظام المكابح المانعة للانزلاق (ABS).',
                dialectSolutions: ['شوف حساسات الفرامل', 'تأكد من سائل الفرامل', 'نضف حساسات ABS'],
                arabicSolutions: ['فحص مستشعرات المكابح', 'التحقق من سائل المكابح', 'تنظيف مستشعرات ABS'],
                severity: 'مرتفع'
            },
            // Body Codes (B0xxx)
            'B1000': {
                type: 'نظام الإضاءة',
                dialectExplanation: 'فيه مشكلة في نظام الضو تاع السيارة.',
                arabicExplanation: 'مشكلة في نظام الإضاءة في السيارة.',
                dialectSolutions: ['شوف الفيوزات', 'تأكد من اللمبات', 'شوف المفاتيح'],
                arabicSolutions: ['فحص المصاهر', 'التحقق من المصابيح', 'فحص المفاتيح'],
                severity: 'منخفض'
            },
            // Network Codes (U0xxx)
            'U0100': {
                type: 'فقدان الاتصال مع ECM',
                dialectExplanation: 'الاتصال بين كمبيوتر السيارة والأنظمة الأخرى انقطع.',
                arabicExplanation: 'فقدان الاتصال بين وحدة التحكم الرئيسية والأنظمة الأخرى.',
                dialectSolutions: ['شوف الكابلات', 'تأكد من الفيوزات', 'ممكن تحتاج تبدل الكمبيوتر'],
                arabicSolutions: ['فحص الأسلاك', 'التحقق من المصاهر', 'قد تحتاج استبدال وحدة التحكم'],
                severity: 'مرتفع'
            }
        };

        // DOM elements
        const carBrand = document.getElementById('carBrand');
        const carModel = document.getElementById('carModel');
        const carYear = document.getElementById('carYear');
        const codeSearch = document.getElementById('codeSearch');
        const searchBtn = document.getElementById('searchBtn');
        const diagnosticResult = document.getElementById('diagnosticResult');
        const codeItems = document.querySelectorAll('.code-item');

        // Initialize year options
        function initializeYears() {
            const currentYear = new Date().getFullYear();
            for (let year = currentYear; year >= 1990; year--) {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                carYear.appendChild(option);
            }
        }

        // Handle car brand change
        carBrand.addEventListener('change', function() {
            const selectedBrand = this.value;
            carModel.innerHTML = '<option value="">اختر الموديل</option>';
            
            if (selectedBrand && carModels[selectedBrand]) {
                carModel.disabled = false;
                carModels[selectedBrand].forEach(model => {
                    const option = document.createElement('option');
                    option.value = model.toLowerCase();
                    option.textContent = model;
                    carModel.appendChild(option);
                });
            } else {
                carModel.disabled = true;
            }
        });

        // Handle OBD code search
        function searchOBDCode(code) {
            const upperCode = code.toUpperCase();
            
            if (obdCodes[upperCode]) {
                displayDiagnosticResult(upperCode, obdCodes[upperCode]);
            } else {
                // Show generic error message
                showGenericError(upperCode);
            }
        }

        // Display diagnostic result
        function displayDiagnosticResult(code, data) {
            document.getElementById('resultTitle').textContent = `نتيجة التشخيص - ${code}`;
            document.getElementById('errorCode').textContent = code;
            document.getElementById('errorType').textContent = data.type;
            document.getElementById('dialectExplanation').textContent = data.dialectExplanation;
            document.getElementById('arabicExplanation').textContent = data.arabicExplanation;
            
            // Display solutions
            const dialectSolutionsList = document.getElementById('dialectSolutions');
            const arabicSolutionsList = document.getElementById('arabicSolutions');
            
            dialectSolutionsList.innerHTML = '';
            arabicSolutionsList.innerHTML = '';
            
            data.dialectSolutions.forEach(solution => {
                const li = document.createElement('li');
                li.className = 'text-gray-300 flex items-start space-x-2 space-x-reverse';
                li.innerHTML = `<span class="text-secondary">•</span><span>${solution}</span>`;
                dialectSolutionsList.appendChild(li);
            });
            
            data.arabicSolutions.forEach(solution => {
                const li = document.createElement('li');
                li.className = 'text-gray-300 flex items-start space-x-2 space-x-reverse';
                li.innerHTML = `<span class="text-accent">•</span><span>${solution}</span>`;
                arabicSolutionsList.appendChild(li);
            });
            
            // Set severity
            setSeverityLevel(data.severity);
            
            // Show result
            diagnosticResult.classList.remove('hidden');
            diagnosticResult.scrollIntoView({ behavior: 'smooth' });
        }

        // Set severity level with colors
        function setSeverityLevel(severity) {
            const indicator = document.getElementById('severityIndicator');
            const text = document.getElementById('severityText');
            
            switch(severity) {
                case 'منخفض':
                    indicator.className = 'w-4 h-4 rounded-full bg-green-500';
                    text.textContent = 'منخفض الخطورة';
                    text.className = 'font-semibold text-green-400';
                    break;
                case 'متوسط':
                    indicator.className = 'w-4 h-4 rounded-full bg-yellow-500';
                    text.textContent = 'متوسط الخطورة';
                    text.className = 'font-semibold text-yellow-400';
                    break;
                case 'مرتفع':
                    indicator.className = 'w-4 h-4 rounded-full bg-red-500';
                    text.textContent = 'عالي الخطورة';
                    text.className = 'font-semibold text-red-400';
                    break;
            }
        }

        // Show generic error for unknown codes
        function showGenericError(code) {
            document.getElementById('resultTitle').textContent = `كود غير موجود في قاعدة البيانات - ${code}`;
            document.getElementById('errorCode').textContent = code;
            document.getElementById('errorType').textContent = 'كود غير مدعوم حالياً';
            document.getElementById('dialectExplanation').textContent = 'هذا الكود مازال مادخلناهوش في قاعدة البيانات. اتصل بميكانيكي متخصص باش يشوفلك المشكلة.';
            document.getElementById('arabicExplanation').textContent = 'هذا الرمز غير موجود حالياً في قاعدة البيانات. يُنصح بمراجعة فني متخصص لتشخيص العطل بدقة.';
            
            document.getElementById('dialectSolutions').innerHTML = '<li class="text-yellow-400">راجع ميكانيكي متخصص في التشخيص الإلكتروني</li>';
            document.getElementById('arabicSolutions').innerHTML = '<li class="text-yellow-400">مراجعة فني متخصص في التشخيص الإلكتروني</li>';
            
            setSeverityLevel('متوسط');
            diagnosticResult.classList.remove('hidden');
            diagnosticResult.scrollIntoView({ behavior: 'smooth' });
        }

        // Event listeners
        searchBtn.addEventListener('click', function() {
            const code = codeSearch.value.trim();
            if (code) {
                searchOBDCode(code);
            } else {
                // Create custom alert modal
                showAlert('من فضلك أدخل كود العطل أولاً');
            }
        });

        codeSearch.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchBtn.click();
            }
        });

        // Handle quick access buttons
        codeItems.forEach(item => {
            item.addEventListener('click', function() {
                const code = this.getAttribute('data-code');
                codeSearch.value = code;
                searchOBDCode(code);
            });
        });

        // Toggle all codes display
        const toggleCodesBtn = document.getElementById('toggleCodesBtn');
        const allCodesContainer = document.getElementById('allCodesContainer');
        const allCodesList = document.getElementById('allCodesList');
        const codeFilter = document.getElementById('codeFilter');

        toggleCodesBtn.addEventListener('click', function() {
            if (allCodesContainer.classList.contains('hidden')) {
                allCodesContainer.classList.remove('hidden');
                this.textContent = 'إخفاء الأكواد';
                populateAllCodes();
            } else {
                allCodesContainer.classList.add('hidden');
                this.textContent = 'عرض جميع الأكواد';
            }
        });

        // Populate all codes
        function populateAllCodes() {
            allCodesList.innerHTML = '';
            const codes = Object.keys(obdCodes).sort();
            codes.forEach(code => {
                const button = document.createElement('button');
                button.className = 'code-item bg-gray-800 hover:bg-gray-700 p-2 rounded text-sm transition-all';
                button.textContent = code;
                button.setAttribute('data-code', code);
                button.addEventListener('click', function() {
                    codeSearch.value = code;
                    searchOBDCode(code);
                    allCodesContainer.classList.add('hidden');
                    toggleCodesBtn.textContent = 'عرض جميع الأكواد';
                });
                allCodesList.appendChild(button);
            });
        }

        // Filter codes
        codeFilter.addEventListener('input', function() {
            const filter = this.value.toUpperCase();
            const buttons = allCodesList.querySelectorAll('button');
            
            buttons.forEach(button => {
                const code = button.textContent;
                const data = obdCodes[code];
                const searchText = `${code} ${data.type} ${data.dialectExplanation}`.toUpperCase();
                
                if (searchText.includes(filter)) {
                    button.style.display = 'block';
                } else {
                    button.style.display = 'none';
                }
            });
        });

        // Custom alert function
        function showAlert(message) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="glass-card p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <p class="text-white mb-4">${message}</p>
                    <div class="flex justify-end">
                        <button class="bg-primary hover:bg-primary/80 px-4 py-2 rounded text-white" onclick="this.closest('.fixed').remove()">حسناً</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Initialize the app
        initializeYears();
    </script>
</body>
</html>
